# Floo Server Configuration (floos.toml)
# ======================================
# Layout mirrors the client template:
#   1. Core listener / security settings
#   2. Services provided by the server (forward) or accepted from clients (reverse)
#   3. Optional performance tuning

# -----------------------------------------------------------------------------
# 1. Core listener + tunnel security
# -----------------------------------------------------------------------------
bind = "0.0.0.0"                        # Interface to bind the tunnel listener
port = 8443                              # TCP port flooc instances will hit
cipher = "aes256gcm"                     # Supported: chacha20poly1305, aes256gcm, aes128gcm, aegis128l, aegis256, none
psk = "replace-with-strong-psk"          # Shared secret for Noise handshake
token = "replace-with-server-token"      # Default per-service token (may be overridden per entry)

# -----------------------------------------------------------------------------
# 2. Services
# -----------------------------------------------------------------------------

# Forward mode: allow clients to connect through the tunnel to targets reachable
# from this server. Format: name = "target_host:target_port[/transport]".
[services]
internal_api = "10.0.0.10:443"          # Reverse proxy to internal HTTPS service
database = "10.0.0.20:5432"             # PostgreSQL reachable only from the server LAN
database.token = "db-per-service-token" # Optional override: clients must present this token
# telemetry = "[fd00::10]:9100"         # IPv6 target example

# Reverse mode: accept connections from clients and bind them on the public server.
# Format: name = "bind_host:bind_port[/transport]".
[reverse_services]
media = "0.0.0.0:8096"                  # Publish home media servers
dev_ssh = "0.0.0.0:2222"                # Provide SSH access via token per service
dev_ssh.token = "ssh-only-token"
# udp_cam = "0.0.0.0:5000/udp"          # Accept UDP video stream

# -----------------------------------------------------------------------------
# 3. Advanced tuning (server-side)
# -----------------------------------------------------------------------------
[advanced]
socket_buffer_size = 524288              # Raise for higher throughput
udp_timeout_seconds = 60                 # How long to keep idle UDP mappings

tcp_nodelay = true
tcp_keepalive = true
tcp_keepalive_idle = 45
tcp_keepalive_interval = 10
tcp_keepalive_count = 3

heartbeat_interval_seconds = 30
heartbeat_timeout_seconds = 45          # Must be > heartbeat_interval_seconds
